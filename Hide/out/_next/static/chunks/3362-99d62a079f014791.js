"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3362],{85056:function(e,t,a){a.d(t,{Z:function(){return R}});var s=a(85893),n=a(67294),l=a(9473),i=a(34051),d=a(31555),r=a(35005),o=a(18296),c=a(58832),u=a.n(c),p=a(38411),h=a.n(p),m=a(54232),f=a(8102),g=a(6763),x=a(51479),v=a(41330),j=a(19755),w=a.n(j);function y(e){let{id:t}=e;return(0,s.jsx)("div",{className:"bsafesImageSpinner",style:{position:"absolute",textAlign:"center"},children:(0,s.jsx)(o.no,{id:t,visible:!0,height:"80",width:"80",ariaLabel:"blocks-loading",wrapperStyle:{},wrapperClass:"blocks-wrapper"})})}var N=a(49411),b=a(49486);function _(e){let{panelIndex:t,panel:a,onVideoClicked:o,editorMode:c,onContentChanged:u,onPenClicked:p,editable:h=!0}=e,j=(0,l.I0)(),_=(0,n.useRef)(null),k=a.s3KeyPrefix,Z=(0,l.v9)(e=>e.container.workspaceKey),[D,C]=(0,n.useState)(!1),I=(e,t)=>{j((0,N.ig)({files:e,where:t,workspaceKey:Z}))};async function S(e){let t=$('<canvas hidden id = "canvas" width = "640" height = "300"></canvas>'),a=t[0];t.insertAfter("body");let s=parseInt(640/(e.videoWidth/e.videoHeight),10);a.width=640,a.height=s;let n=a.getContext("2d"),l=()=>{if(D)return;console.log("takeAShot..."),console.log("snapshotTaken",D),n.fillRect(0,0,640,s),n.drawImage(e,0,0,640,s),console.log("myWidth, myHeight",640,s);let t=n.getImageData(0,0,640,s),i=!0;for(let e=0;e<t.data.length;e++)if((e+1)%4&&0!==t.data[e]){i=!1;break}i?(setTimeout(l,1e3),console.log("Blank snapshot")):a.toBlob(e=>{let t=new FileReader;t.onload=()=>{j((0,N.MV)({s3KeyPrefix:k,snapshot:t.result}))},t.readAsBinaryString(e),C(!0)})};setTimeout(l,100)}return(0,n.useEffect)(()=>{window.$=window.jQuery=w()},[]),(0,s.jsxs)("div",{children:[(0,s.jsx)("input",{ref:_,onChange:e=>{e.preventDefault(),(0,b.qu)(!1,"handleVideoFiles: ",e.target.id);let a=e.target.files;a.length&&I(a,t)},type:"file",accept:"video/*",className:"d-none editControl",id:"videos"}),(0,s.jsx)(i.Z,{className:"",children:(0,s.jsxs)(d.Z,{children:["Uploaded"===a.status||"Downloaded"===a.status||"DownloadFailed"===a.status||"DownloadingVideo"===a.status||"DownloadedFromServiceWorker"===a.status||"Downloading"===a.status||"DownloadingThumbnail"===a.status||"ThumbnailDownloaded"===a.status?(0,s.jsx)("div",{className:"d-flex justify-content-center align-items-center w-100",children:a.play?(0,s.jsx)(s.Fragment,{children:a.src?(0,s.jsx)("video",{alt:"Video broken",playsInline:!0,controls:!0,autoPlay:!0,muted:!0,poster:a.thumbnail,src:a.src,onPlaying:e=>{(0,b.qu)(!1,"onPlaying ..."),"Uploaded"===a.status&&S(e.target)},onCanPlay:e=>{(0,b.qu)(!1,"onCanPlay ...")},onLoadedMetadata:e=>{(0,b.qu)(!1,"onLoadedMetaData ..., autoplay muted ")},onLoadedData:e=>{(0,b.qu)(!1,"onLoadedData ...")},className:"w-100"}):(0,s.jsx)(s.Fragment,{children:(0,s.jsx)(v.Z,{alt:"image broken",src:a.thumbnail,fluid:!0})})}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(v.Z,{alt:"image broken",src:a.thumbnail||a.placeholder,fluid:!0}),(0,s.jsx)("div",{style:{position:"absolute",width:"100px",borderRadius:"10px",textAlign:"center",background:"white",opacity:"0.5",cursor:"pointer"},onClick:()=>{o(a.queueId)},children:(0,s.jsx)("i",{className:"fa fa-play-circle-o fa-4x text-danger","aria-hidden":"true"})}),("Downloading"===a.status||"DownloadingVideo"===a.status)&&(0,s.jsx)(y,{})]})}):"","Uploading"===a.status?(0,s.jsx)(x.Z,{now:a.progress}):"",("WaitingForUpload"===a.status||"WaitingForDownload"===a.status)&&(0,s.jsx)("i",{className:"fa fa-video-camera","aria-hidden":"true"})]})}),(0,s.jsxs)(i.Z,{children:[(0,s.jsx)(d.Z,{xs:8,sm:9,children:(0,s.jsx)("div",{className:"pt-2",children:(0,s.jsx)(m.Z,{editorId:t,mode:c,content:a.words,onContentChanged:u,showPen:!1,editable:h,hideIfEmpty:!0})})}),(0,s.jsx)(d.Z,{xs:4,sm:3,className:"p-0",children:"Uploading"!==a.status||"WaitingForUpload"===a.status?(0,s.jsxs)("div",{children:[h?(0,s.jsx)(f.Z,{variant:"link",align:"end",title:(0,s.jsx)("span",{children:(0,s.jsx)("i",{className:"text-dark fa fa-ellipsis-v","aria-hidden":"true"})}),className:"pull-right",id:"dropdown-menu-align-end",children:(0,s.jsx)(g.Z.Item,{eventKey:"2",className:"deleteVideoBtn",onClick:()=>{confirm("Are you sure you want to delete this video?")&&j((0,N.deleteAVideoThunk)({panel:a}))},children:"Delete Video"})}):"",h?(0,s.jsx)(r.Z,{id:t,onClick:e=>{var t;(0,b.qu)(!1,"handleVideoBtn"),e.preventDefault(),_.current.value=null,null===(t=_.current)||void 0===t||t.click()},variant:"link",className:"px-1 text-dark btn btn-labeled pull-right",children:(0,s.jsx)("i",{id:t,className:"fa fa-video-camera fa-lg","aria-hidden":"true"})}):"",h?(0,s.jsx)(r.Z,{variant:"link",onClick:()=>{p(t)},className:"px-1 text-dark pull-right",children:(0,s.jsx)("i",{className:"fa fa-pencil","aria-hidden":"true"})}):""]}):""})]})]})}function k(e){let{panelIndex:t,panel:a,onImageClicked:o,editorMode:c,onContentChanged:u,onPenClicked:p,editable:h=!0}=e,j=(0,l.I0)(),w=(0,n.useRef)(null),y=(0,l.v9)(e=>e.container.workspaceKey),_=(e,t)=>{j((0,N.VZ)({files:e,where:t,workspaceKey:y}))};return(0,s.jsxs)("div",{children:[(0,s.jsx)("input",{ref:w,onChange:e=>{e.preventDefault(),(0,b.qu)(!1,"handleImageFiles: ",e.target.id);let a=e.target.files;a.length&&_(a,t)},type:"file",multiple:!0,accept:"image/*",className:"d-none editControl",id:"images"}),(0,s.jsx)(i.Z,{className:"",children:(0,s.jsxs)(d.Z,{children:["Uploaded"===a.status||"Downloaded"===a.status?(0,s.jsx)("div",{children:(0,s.jsx)(v.Z,{alt:"Image broken",src:a.src,onClick:()=>{o(a.queueId)},fluid:!0})}):"","Uploading"===a.status||"Downloading"===a.status?(0,s.jsx)(x.Z,{now:a.progress}):"",("WaitingForUpload"===a.status||"WaitingForDownload"===a.status)&&(0,s.jsx)("i",{className:"fa fa-picture-o","aria-hidden":"true"})]})}),(0,s.jsxs)(i.Z,{children:[(0,s.jsx)(d.Z,{xs:8,sm:9,children:(0,s.jsx)("div",{className:"pt-2",children:(0,s.jsx)(m.Z,{editorId:t,mode:c,content:a.words,onContentChanged:u,showPen:!1,editable:h,hideIfEmpty:!0})})}),(0,s.jsx)(d.Z,{xs:4,sm:3,className:"p-0",children:"Uploaded"===a.status||"Downloaded"===a.status?(0,s.jsxs)("div",{children:[h?(0,s.jsx)(f.Z,{variant:"link",align:"end",title:(0,s.jsx)("span",{children:(0,s.jsx)("i",{className:"text-dark fa fa-ellipsis-v","aria-hidden":"true"})}),className:"pull-right",id:"dropdown-menu-align-end",children:(0,s.jsx)(g.Z.Item,{eventKey:"2",className:"deleteImageBtn",onClick:()=>{confirm("Are you sure you want to delete this image?")&&j((0,N.cJ)({panel:a}))},children:"Delete Image"})}):"",h?(0,s.jsx)(r.Z,{id:t,onClick:e=>{var t;(0,b.qu)(!1,"handleImageBtn"),e.preventDefault(),w.current.value=null,null===(t=w.current)||void 0===t||t.click()},variant:"link",className:"px-1 text-dark btn btn-labeled pull-right",children:(0,s.jsx)("i",{id:t,className:"fa fa-picture-o fa-lg","aria-hidden":"true"})}):"",h?(0,s.jsx)(r.Z,{variant:"link",onClick:()=>{p(t)},className:"px-1 text-dark pull-right",children:(0,s.jsx)("i",{className:"fa fa-pencil","aria-hidden":"true"})}):""]}):""})]})]})}var Z=a(76822),D=a(52686),C=a(6728),I=a(43489),S=a(38712),q=a.n(S),F=a(51892);function E(e){let{panelIndex:t,panel:a}=e,o=(0,l.I0)(),c=(0,l.v9)(e=>e.container.workspaceKey),u=(0,n.useRef)(null),p=async()=>{o((0,N.sg)({panel:a,workspaceKey:c}))};return(0,n.useEffect)(()=>{if(a.link){var e;null===(e=u.current)||void 0===e||e.click()}},[a]),(0,s.jsx)(D.Z,{children:(0,s.jsxs)(D.Z.Body,{children:[(0,s.jsxs)(i.Z,{children:[(0,s.jsx)(d.Z,{xs:8,md:9,children:(0,s.jsxs)("h6",{children:[(0,s.jsx)("i",{className:"fa fa-file-o","aria-hidden":"true"})," ",(0,s.jsx)("span",{className:"attachmentFileName",children:a.fileName})]})}),(0,s.jsx)(d.Z,{xs:4,md:3,children:(0,s.jsxs)("div",{children:[(0,s.jsx)(f.Z,{variant:"link",align:"end",title:(0,s.jsx)("span",{children:(0,s.jsx)("i",{className:"text-dark fa fa-ellipsis-v fa-lg","aria-hidden":"true"})}),className:"".concat(q().attachmentMoreBtn," pull-right"),id:"dropdown-menu-align-end",children:(0,s.jsx)(g.Z.Item,{eventKey:"1",onClick:()=>{confirm("Are you sure you want to delete this attachment?")&&o((0,N.ex)({panel:a}))},children:"Delete"})}),("Uploaded"===a.status||"Downloaded"===a.status)&&(0,s.jsx)(r.Z,{variant:"link",className:"pt-0 px-2 pull-right",onClick:p,children:(0,s.jsx)("i",{className:"text-dark fa fa-download fa-lg","aria-hidden":"true"})}),(0,s.jsx)("a",{ref:u,href:a.link,download:a.fileName,className:"d-none",children:"Save"}),("UploadFailed"===a.status||"DownloadFailed"===a.status)&&(0,s.jsx)(C.Z,{placement:"top",overlay:(0,s.jsx)(I.Z,{id:"ResumeUploadingFile",children:"Resume"}),children:(0,s.jsx)(r.Z,{variant:"link",className:"pt-0 px-2 pull-right",onClick:()=>{"UploadFailed"===a.status||o((0,N.sg)({panel:null,workspaceKey:c}))},children:(0,s.jsx)("i",{className:"text-dark fa fa-play-circle-o fa-lg","aria-hidden":"true"})})}),("WaitingForUpload"===a.status||"WaitingForDownload"===a.status)&&(0,s.jsx)(r.Z,{variant:"link",className:"pt-0 px-2 pull-right",children:(0,s.jsx)("i",{className:"text-dark fa fa-hand-paper-o fa-lg","aria-hidden":"true"})}),("Uploading"===a.status||"Downloading"===a.status)&&(0,s.jsx)(C.Z,{placement:"top",overlay:(0,s.jsx)(I.Z,{id:"StopUploadingFile",children:"Stop"}),children:(0,s.jsx)(r.Z,{variant:"link",className:"pt-0 px-2 pull-right",onClick:()=>{"Uploading"===a.status?o((0,N.k2)()):o((0,N.dc)())},children:(0,s.jsx)("i",{className:"text-dark fa fa-pause fa-lg","aria-hidden":"true"})})})]})})]}),(0,s.jsxs)(i.Z,{children:[(0,s.jsx)(d.Z,{xs:8,md:9,children:(0,s.jsx)("p",{className:"mb-0",children:(0,F.x6)(a.fileSize)+" bytes"})}),(0,s.jsx)(d.Z,{xs:4,md:3,children:("Uploading"===a.status||"UploadFailed"===a.status||"Downloading"===a.status||"DownloadFailed"===a.status)&&(0,s.jsxs)("p",{className:"pull-right",children:[(Math.round(100*a.progress)/100).toFixed(2)," %"]})})]}),(0,s.jsx)(i.Z,{children:(0,s.jsx)(d.Z,{children:"Uploading"===a.status||"UploadFailed"===a.status||"Downloading"===a.status||"DownloadFailed"===a.status?(0,s.jsx)(x.Z,{now:a.progress}):""})})]})})}function R(){let e=(0,l.I0)(),t=(0,l.v9)(e=>e.container.workspaceKey),a=(0,l.v9)(e=>e.container.searchKey),c=(0,l.v9)(e=>e.container.searchIV),p=(0,l.v9)(e=>e.page.activity),f=(0,l.v9)(e=>e.page.id);(0,l.v9)(e=>e.page.itemCopy);let g=(0,l.v9)(e=>e.page.oldVersion),[x,v]=(0,n.useState)("ReadOnly"),j=(0,l.v9)(e=>e.page.title),[w,y]=(0,n.useState)("ReadOnly"),D=(0,l.v9)(e=>e.page.content),[C,I]=(0,n.useState)(null),[S,F]=(0,n.useState)(null),[R,W]=(0,n.useState)(!1),L=(0,l.v9)(e=>e.page.S3SignedUrlForContentUpload),V=(0,l.v9)(e=>e.page.contentImagesDownloadQueue),B=(0,l.v9)(e=>e.page.contentImagesDisplayIndex),A=(0,l.v9)(e=>e.page.contentImagesAllDownloaded),U=B===V.length,P=(0,l.v9)(e=>e.page.contentVideosDownloadQueue),O=(0,l.v9)(e=>e.page.videoPanels),T=(0,l.v9)(e=>e.page.imagePanels),M=(0,l.v9)(e=>e.page.attachmentPanels),K=(0,l.v9)(e=>e.page.comments),H=(0,l.v9)(e=>e.page.draftLoaded),[z,Q]=(0,n.useState)(!1),[X,Y]=(0,n.useState)(!1),J=(0,n.useRef)(null),G=(0,n.useRef)(null),ee=(0,n.useRef)(null),[et,ea]=(0,n.useState)(!1),es=(0,n.useRef)(null),[en,el]=(0,n.useState)(!1),ei=(0,n.useRef)(null),[ed,er]=(0,n.useState)(!1),eo=t=>{for(let a of((0,b.qu)(!1,"onVideoClicked: ",t),O))if(a.queueId===t){let t=a.queueId,s=a.s3KeyPrefix,n=a.numberOfChunks;e((0,N.f2)({id:t,s3KeyPrefix:s,numberOfChunks:n,fileName:a.fileName,fileType:a.fileType,fileSize:a.fileSize}));break}},ec=e=>{let t;(0,b.qu)(!1,"onImageClicked: ",e);let a=[];for(let s=0;s<T.length;s++){let n=T[s];if("Uploaded"!==n.status&&"Downloaded"!==n.status)continue;let l={};l.src=n.src,l.w=n.width,l.h=n.height,a.push(l),n.queueId===e&&(t=a.length-1)}let s=G.current,n={history:!1,index:t};new(u())(s,h(),a,n).init()},eu=t=>{let a=t.target;"I"===t.target.tagName&&(a=t.target.parentNode);let s=a.id.replace("playVideoCenter_",""),n=a.parentNode;a.remove();let l=ep(s);n.appendChild(l);let i=s.split("&");if("chunks"===i[0]){let t=i[3],a=parseInt(i[1]),n=i[2],l=parseInt(i[5]),d=i[4];e((0,N.f2)({fromContent:!0,id:s,s3KeyPrefix:t,numberOfChunks:a,fileName:n,fileType:d,fileSize:l}))}else{let t=i[0];e((0,N.f2)({id:s,s3Key:t}))}};function ep(e){let t=J.current.cloneNode(!0);return t.className="bsafesImageSpinner",t.id="spinner_"+e,t.style.position="absolute",t.style.textAlign="center",t.removeAttribute("hidden"),t}function eh(e){let t=document.createElement("div"),a="playVideoCenter_"+e.id,s="playVideoButton_"+e.id;return t.className="bsafesPlayVideo",t.id=a,t.style.position="absolute",t.style.width="100px",t.style.borderRadius="10px",t.style.textAlign="center",t.style.background="white",t.style.opacity="0.5",t.innerHTML='<i class="fa fa-play-circle-o fa-4x text-danger" id='.concat(s,' aria-hidden="true"></i>'),t}function em(){document.querySelectorAll(".bsafesImageSpinner").forEach(e=>{e.remove()}),document.querySelectorAll(".bsafesPlayVideo").forEach(e=>{e.remove()}),I(document.querySelector(".contenEditorRow").querySelector(".inner-html").innerHTML),e((0,N.kj)()),y("Writing")}let ef=t=>{(0,b.qu)(!1,"pen ".concat(t," clicked"));let a=!0;if("content"===t)em(),F("content"),a=!1;else if("title"===t)v("Writing"),F("title");else if(t.startsWith("video_")){let a=parseInt(t.split("_")[1]);e((0,N.es)({index:a,mode:"Writing"})),F(t)}else if(t.startsWith("image_")){let a=parseInt(t.split("_")[1]);e((0,N.kW)({index:a,mode:"Writing"})),F(t)}else t.startsWith("comment_")&&(e((0,N.pV)({index:t,mode:"Writing"})),F(t));W(a)},eg=(s,n)=>{if((0,b.qu)(!1,"editor-id: ".concat(s," content: ").concat(n)),"content"===S)n!==D?e((0,N.Qs)({content:n,workspaceKey:t})):(ew("ReadOnly"),F(null));else if("title"===S)n!==j?e((0,N.Vf)(n,t,a,c)):(ew("ReadOnly"),F(null));else if(S.startsWith("video_")){let t=parseInt(S.split("_")[1]);console.log(n,O[t].words),n!==O[t].words?e((0,N.f)({index:t,content:n})):(e((0,N.es)({index:t,mode:"ReadOnly"})),F(null))}else if(S.startsWith("image_")){let t=parseInt(S.split("_")[1]);n!==T[t].words?e((0,N.Hk)({index:t,content:n})):(e((0,N.kW)({index:t,mode:"ReadOnly"})),F(null))}else if(S.startsWith("comment_")){if("comment_New"!==S&&K[parseInt(S.split("_")[1])].content===n){e((0,N.pV)({index:S,mode:"ReadOnly"})),F(null);return}e((0,N.qH)({index:S,content:n}))}},ex=O.map((e,t)=>(0,s.jsx)(_,{panelIndex:"video_"+t,panel:e,onVideoClicked:eo,editorMode:e.editorMode,onPenClicked:ef,onContentChanged:eg,editable:!S&&0===p},e.queueId)),ev=T.map((e,t)=>(0,s.jsx)(k,{panelIndex:"image_"+t,panel:e,onImageClicked:ec,editorMode:e.editorMode,onPenClicked:ef,onContentChanged:eg,editable:!S&&0===p},e.queueId)),ej=()=>{(0,b.qu)(!1,"handleWrite"),em(),F("content")},ew=t=>{switch(S){case"content":y(t);break;case"title":v(t);break;default:if(S.startsWith("video_")){let a=parseInt(S.split("_")[1]);switch(t){case"Saving":case"ReadOnly":e((0,N.es)({index:a,mode:t}))}}else if(S.startsWith("image_")){let a=parseInt(S.split("_")[1]);switch(t){case"Saving":case"ReadOnly":e((0,N.kW)({index:a,mode:t}))}}else if(S.startsWith("comment_"))switch(t){case"Writing":case"Saving":case"ReadOnly":e((0,N.pV)({index:S,mode:t}))}}},ey=(a,s)=>{e((0,N.ig)({files:a,where:s,workspaceKey:t}))},eN=(a,s)=>{e((0,N.VZ)({files:a,where:s,workspaceKey:t}))},eb=M.map((e,t)=>(0,s.jsx)(E,{panelIndex:"attachment_"+t,panel:e},e.queueId)),e_=a=>{e((0,N.F1)({files:a,workspaceKey:t}))},ek=(e,t)=>{"videos"===e.target.id?ea(t):"images"===e.target.id?el(t):er(t)},eZ=e=>{(0,b.qu)(!1,"handleDrag"),e.preventDefault(),e.stopPropagation(),"dragenter"===e.type||"dragover"===e.type?ek(e,!0):"dragleave"===e.type&&ek(e,!1)},eD=function(e){if((0,b.qu)(!1,"handleDrop: ",e.target.id),e.preventDefault(),e.stopPropagation(),ek(e,!1),e.dataTransfer.files&&e.dataTransfer.files[0]){if((0,b.qu)(!1,"handleDrop, at least one file."),"videos"===e.target.id){let t=/video.*/,a=[];for(let s of e.dataTransfer.files)s.type.match(t)?a.push(s):(0,b.qu)(!1,"Not an image.");ey(a,"top")}else if("images"===e.target.id){let t=/image.*/,a=[];for(let s of e.dataTransfer.files)s.type.match(t)?a.push(s):(0,b.qu)(!1,"Not an image.");eN(a,"top")}else if("attachments"===e.target.id){(0,b.qu)(!1,"handleDrop attachments: ",e.dataTransfer.files.length);let t=[];for(let a of e.dataTransfer.files)t.push(a);e_(t)}}ek(e,!1)};return(0,n.useEffect)(()=>{(0,b.qu)(!1,"pageCommons mounted.")},[]),(0,n.useEffect)(()=>{I(null)},[f]),(0,n.useEffect)(()=>{0===p?S&&(ew("ReadOnly"),F(null)):"Error"===p&&S&&ew("Writing")},[p]),(0,n.useEffect)(()=>{null!==D&&I(D)},[D]),(0,n.useEffect)(()=>{let t,a,s;if((!H||z)&&(document.querySelectorAll(".videoControls").forEach(e=>{e.remove()}),B<V.length)){if(t=V[B],!(a=document.getElementById(t.id))){e((0,N.XZ)(B+1));return}if(a.parentNode.classList.contains("bsafesMediaContainer")){if(s=a.parentNode,!document.getElementById("spinner_"+t.id)){let e=ep(t.id);s.appendChild(e)}}else{(s=document.createElement("div")).className="bsafesMediaContainer",s.style.display="flex",s.style.alignItems="center",s.style.justifyContent="center";let e=a.cloneNode(!0);s.appendChild(e),a.replaceWith(s),a=e;let n=ep(t.id);s.appendChild(n)}if("Downloading"===t.status)return;if("Downloaded"===t.status||"DownloadFailed"===t.status){let n=document.getElementById("spinner_"+t.id);if(n&&n.remove(),"Downloaded"===t.status&&(a.src=t.src),a.classList.contains("bSafesDownloadVideo")){let e=null;(e=document.getElementById("playVideoCenter_"+t.id))||"ReadOnly"!==w||(e=eh(t),s.appendChild(e)),"ReadOnly"===w&&(e.onclick=eu)}e((0,N.XZ)(B+1))}}},[V,z]),(0,n.useEffect)(()=>{let t,a;for(let s=0;s<P.length;s++){let n=(t=P[s]).id;if(a=document.getElementById(n),"Downloading"===t.status);else if("Downloaded"===t.status||"DownloadedFromServiceWorker"===t.status){let l=document.getElementById("spinner_"+n);if(l&&l.remove(),!a.classList.contains("fr-video")){let l=document.createElement("span");l.className="fr-video",l.classList.add("fr-draggable"),l.setAttribute("contenteditable","true"),l.setAttribute("draggable","true");let i=document.createElement("video");i.className="bSafesVideo",i.classList.add("fr-draggable"),i.classList.add("fr-dvi"),i.classList.add("fr-fvc"),i.setAttribute("controls",""),i.innerHTML="Your browser does not support HTML5 video.",i.id=n,i.src=t.src,i.style=a.style,i.addEventListener("loadeddata",e=>{i.play()}),a.classList.contains("fr-dib")&&l.classList.add("fr-dvb"),a.classList.contains("fr-dii")&&l.classList.add("fr-dvi"),a.classList.contains("fr-fil")&&l.classList.add("fr-fvl"),a.classList.contains("fr-fic")&&l.classList.add("fr-fvc"),a.classList.contains("fr-fir")&&l.classList.add("fr-fvr"),l.appendChild(i),a.replaceWith(l),e((0,N.Z8)({itemId:f,indexInQueue:s}))}}}},[P]),(0,n.useEffect)(()=>{"ReadOnly"===w&&(0,b.qu)(!1,"ReadOnly")},[w]),(0,n.useEffect)(()=>{H&&Q(!0)},[H]),(0,n.useEffect)(()=>{z&&e((0,N.Y2)())},[z]),(0,n.useEffect)(()=>{A&&H&&(ej(),Y(!1),Q(!1))},[A,H]),(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(i.Z,{className:"justify-content-center",children:(0,s.jsx)(d.Z,{sm:"10",children:(0,s.jsx)("hr",{})})}),(0,s.jsx)(i.Z,{className:"justify-content-center",children:(0,s.jsx)(d.Z,{sm:"10",children:(0,s.jsx)(m.Z,{editorId:"title",mode:x,content:j,onContentChanged:eg,onPenClicked:ef,editable:!S&&0===p&&!g})})}),(0,s.jsx)(i.Z,{className:"justify-content-center",children:(0,s.jsx)(d.Z,{sm:"10",children:(0,s.jsx)("hr",{})})}),(0,s.jsx)(i.Z,{className:"justify-content-center",children:(0,s.jsx)(d.Z,{className:"contenEditorRow",xs:"12",sm:"10",children:(0,s.jsx)(m.Z,{editorId:"content",mode:w,content:C||D,onContentChanged:eg,onPenClicked:ef,editable:!S&&0===p&&!g&&U,writingModeReady:e=>{},readOnlyModeReady:e=>{let t=document.getElementsByClassName("bSafesDownloadVideo");for(let e=0;e<t.length;e++){let a=t[e],s=a.parentNode,n=eh(a);s.appendChild(n),n.onclick=eu}},onDraftSampled:t=>{(0,b.qu)(!1,"draft content: ",t),e((0,N.hL)({content:t}))},onDraftClicked:()=>{e((0,N.KT)())},onDraftDelete:()=>{e((0,N._D)())}})})}),(0,s.jsx)("br",{}),(0,s.jsx)("br",{}),!S&&0===p&&!g&&(0,s.jsxs)("div",{className:"videos",children:[(0,s.jsx)("input",{ref:ee,onChange:e=>{e.preventDefault(),(0,b.qu)(!1,"handleVideoFiles: ",e.target.id);let t=e.target.files;t.length&&ey(t,"top")},type:"file",accept:"video/*",multiple:!0,className:"d-none editControl",id:"videos"}),(0,s.jsx)(i.Z,{children:(0,s.jsx)(d.Z,{id:"videos",onDragEnter:eZ,onDragLeave:eZ,onDragOver:eZ,onDrop:eD,sm:{span:10,offset:1},md:{span:8,offset:2},className:"text-center ".concat(et?q().videosDragDropZoneActive:q().videosDragDropZone),children:(0,s.jsx)(r.Z,{id:"videos",onClick:e=>{var t;(0,b.qu)(!1,"handleVideoBtn"),e.preventDefault(),ee.current.value=null,null===(t=ee.current)||void 0===t||t.click()},variant:"link",className:"text-dark btn btn-labeled",children:(0,s.jsx)("h4",{children:(0,s.jsx)("i",{id:"videos",className:"fa fa-video-camera fa-lg","aria-hidden":"true"})})})})})]}),(0,s.jsx)(i.Z,{className:"justify-content-center",children:(0,s.jsx)(d.Z,{xs:"12",md:"8",children:ex})}),(0,s.jsx)("br",{}),!S&&0===p&&!g&&(0,s.jsxs)("div",{className:"images",children:[(0,s.jsx)("input",{ref:es,onChange:e=>{e.preventDefault(),(0,b.qu)(!1,"handleImageFiles: ",e.target.id);let t=e.target.files;t.length&&eN(t,"top")},type:"file",multiple:!0,accept:"image/*",className:"d-none editControl",id:"images"}),(0,s.jsx)(i.Z,{children:(0,s.jsx)(d.Z,{id:"images",onDragLeave:eZ,onDragOver:eZ,onDrop:eD,sm:{span:10,offset:1},md:{span:8,offset:2},className:"text-center ".concat(en?q().imagesDragDropZoneActive:q().imagesDragDropZone),children:(0,s.jsx)(r.Z,{id:"images",onClick:e=>{var t;(0,b.qu)(!1,"handleImageBtn"),e.preventDefault(),es.current.value=null,null===(t=es.current)||void 0===t||t.click()},variant:"link",className:"text-dark btn btn-labeled",children:(0,s.jsx)("h4",{children:(0,s.jsx)("i",{id:"images",className:"fa fa-picture-o fa-lg","aria-hidden":"true"})})})})})]}),(0,s.jsx)(i.Z,{className:"justify-content-center",children:(0,s.jsx)(d.Z,{xs:"12",sm:"10",lg:"8",children:ev})}),(0,s.jsx)("br",{}),!S&&0===p&&!g&&(0,s.jsxs)("div",{className:"attachments",children:[(0,s.jsx)("input",{ref:ei,onChange:e=>{e.preventDefault(),(0,b.qu)(!1,"handleAttachments: ",e.target.id);let t=e.target.files;t.length&&e_(t)},type:"file",multiple:!0,className:"d-none editControl",id:"attachments"}),(0,s.jsx)(i.Z,{children:(0,s.jsx)(d.Z,{id:"attachments",onDragLeave:eZ,onDragOver:eZ,onDrop:eD,sm:{span:10,offset:1},md:{span:8,offset:2},className:"text-center ".concat(ed?q().attachmentsDragDropZoneActive:q().attachmentsDragDropZone),children:(0,s.jsx)(r.Z,{id:"attachments",onClick:e=>{var t;(0,b.qu)(!1,"handleAttachmentBtn"),e.preventDefault(),ei.current.value=null,null===(t=ei.current)||void 0===t||t.click()},variant:"link",className:"text-dark btn btn-labeled",children:(0,s.jsx)("h4",{children:(0,s.jsx)("i",{id:"attachments",className:"fa fa-paperclip fa-lg","aria-hidden":"true"})})})})})]}),(0,s.jsx)(i.Z,{className:"justify-content-center",children:(0,s.jsx)(d.Z,{xs:"12",md:"8",children:eb})}),(0,s.jsx)("br",{}),(0,s.jsxs)("div",{ref:G,className:"pswp",tabIndex:"-1",role:"dialog","aria-hidden":"true",children:[(0,s.jsx)("div",{className:"pswp__bg"}),(0,s.jsxs)("div",{className:"pswp__scroll-wrap",children:[(0,s.jsxs)("div",{className:"pswp__container",children:[(0,s.jsx)("div",{className:"pswp__item"}),(0,s.jsx)("div",{className:"pswp__item"}),(0,s.jsx)("div",{className:"pswp__item"})]}),(0,s.jsxs)("div",{className:"pswp__ui pswp__ui--hidden",children:[(0,s.jsxs)("div",{className:"pswp__top-bar",children:[(0,s.jsx)("div",{className:"pswp__counter"}),(0,s.jsx)("button",{className:"pswp__button pswp__button--close",title:"Close (Esc)"}),(0,s.jsx)("button",{className:"pswp__button pswp__button--share",title:"Share"}),(0,s.jsx)("button",{className:"pswp__button pswp__button--fs",title:"Toggle fullscreen"}),(0,s.jsx)("button",{className:"pswp__button pswp__button--zoom",title:"Zoom in/out"}),(0,s.jsx)("div",{className:"pswp__preloader",children:(0,s.jsx)("div",{className:"pswp__preloader__icn",children:(0,s.jsx)("div",{className:"pswp__preloader__cut",children:(0,s.jsx)("div",{className:"pswp__preloader__donut"})})})})]}),(0,s.jsx)("div",{className:"pswp__share-modal pswp__share-modal--hidden pswp__single-tap",children:(0,s.jsx)("div",{className:"pswp__share-tooltip"})}),(0,s.jsx)("button",{className:"pswp__button pswp__button--arrow--left",title:"Previous (arrow left)"}),(0,s.jsx)("button",{className:"pswp__button pswp__button--arrow--right",title:"Next (arrow right)"}),(0,s.jsx)("div",{className:"pswp__caption",children:(0,s.jsx)("div",{className:"pswp__caption__center"})})]})]})]}),!1,(0,s.jsx)(Z.Z,{isEditing:S,onWrite:ej,readyForSaving:null!==L||R,onSave:()=>{(0,b.qu)(!1,"handleSave"),ew("Saving"),e((0,N.hX)(!1)),W(!1)},onCancel:()=>{(0,b.qu)(!1,"handleCancel"),e((0,N.ZC)(null)),ew("ReadOnly"),F(null),H&&e((0,N.eD)()),e((0,N.hX)(!1)),W(!1)},canEdit:!S&&0===p&&!g&&U}),(0,s.jsx)("div",{ref:J,className:"bsafesMediaSpinner",hidden:!0,children:(0,s.jsx)(o.no,{visible:!0,height:"80",width:"80",ariaLabel:"blocks-loading",wrapperStyle:{},wrapperClass:"blocks-wrapper"})})]})}},93530:function(e,t,a){a.d(t,{Z:function(){return c}});var s=a(85893),n=a(67294),l=a(35005),i=a(35015),d=a(72021),r=a(38712),o=a.n(r);function c(e){let{onNextClicked:t,onPreviousClicked:a,cover:r=!1,showAlert:c=!1,alertClosed:u=null}=e,[p,h]=(0,n.useState)(!1);return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(l.Z,{className:"".concat(o().previousPageBtn," ").concat(r?o().coverBtnFixed:o().pageBtnFixed),onClick:()=>{h(!1),a()},children:(0,s.jsx)("i",{className:"fa fa-chevron-left fa-lg","aria-hidden":"true"})}),(0,s.jsx)(l.Z,{className:"".concat(o().nextPageBtn," ").concat(r?o().coverBtnFixed:o().pageBtnFixed," pull-right"),onClick:()=>{h(!1),t()},children:(0,s.jsx)("i",{className:"fa fa-chevron-right fa-lg","aria-hidden":"true"})}),(0,s.jsx)(d.Z,{className:"p-3",position:r?"top-center":"middle-center",style:{zIndex:1e4},children:(0,s.jsxs)(i.Z,{show:c&&!p,onClose:()=>{h(!0),u()},bg:"warning",children:[(0,s.jsxs)(i.Z.Header,{children:[(0,s.jsx)("strong",{className:"me-auto",children:"Alert"}),(0,s.jsx)("small",{})]}),(0,s.jsx)(i.Z.Body,{children:"Hello, your have reached the end."})]})})]})}}}]);