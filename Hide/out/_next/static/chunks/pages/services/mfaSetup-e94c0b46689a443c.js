(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[455],{26028:function(e,r,s){(window.__NEXT_P=window.__NEXT_P||[]).push(["/services/mfaSetup",function(){return s(91677)}])},80740:function(e,r,s){"use strict";s.d(r,{Z:function(){return d}});var n=s(85893),t=s(67294),a=s(35005),i=s(13137),l=s(76515),c=s(38712),o=s.n(c);function d(e){let{onKeyChanged:r,recoveredKeyPassword:s,focus:c=!1}=e,d=(0,t.useRef)(null),[u,h]=(0,t.useState)(""),[x,j]=(0,t.useState)(!0);return(0,t.useEffect)(()=>{s&&h(s)},[s]),(0,t.useEffect)(()=>{c&&d.current.focus()},[c]),(0,n.jsx)(n.Fragment,{children:(0,n.jsxs)(l.Z,{children:[(0,n.jsx)(i.Z.Control,{ref:d,type:x?"password":"text",onChange:e=>{h(e.target.value),r(e.target.value)},value:u,className:o().inputBox}),(0,n.jsx)(a.Z,{className:o().inputButton,onClick:e=>{j(!x)},variant:"dark",children:x?(0,n.jsx)("i",{id:"1",className:"fa fa-eye-slash fa-lg","aria-hidden":"true"}):(0,n.jsx)("i",{id:"1",className:"fa fa-eye fa-lg","aria-hidden":"true"})})]})})}s(49486)},91677:function(e,r,s){"use strict";s.r(r),s.d(r,{default:function(){return g}});var n=s(85893),t=s(67294),a=s(9473),i=s(10682),l=s(34051),c=s(31555),o=s(13137),d=s(35005),u=s(32171),h=s(76515),x=s(92592),j=s(38712),f=s.n(j),p=s(31243),y=s(80740),v=s(94882),Z=s(49486),m=s(17384);function g(){let e=(0,a.I0)(),[r,s]=(0,t.useState)(""),[j,g]=(0,t.useState)(!1),[w,S]=(0,t.useState)(null),[C,N]=(0,t.useState)(!1),[b,k]=(0,t.useState)(!1),[A,E]=(0,t.useState)(null),[F,_]=(0,t.useState)(""),[R,T]=(0,t.useState)(!1),[B,I]=(0,t.useState)(!1),[H,z]=(0,t.useState)(null),[D,O]=(0,t.useState)(!1),[U,q]=(0,t.useState)(""),L=(0,t.useRef)(null),P=(0,a.v9)(e=>e.auth.isLoggedIn),W=(0,a.v9)(e=>e.auth.keySalt),Y=(0,a.v9)(e=>e.account.accountHashVerified),Q=(0,a.v9)(e=>e.account.mfa),G=async()=>{let s=await (0,v.IA)(r,W);e((0,m.q$)({accountHash:s}))},V=async()=>{try{e((0,m.Qz)({token:F,accountHash:w})),_("")}catch(e){alert(e)}},X=()=>{q(""),O(!1)},K=async()=>{e((0,m._n)({accountHash:w})),X()};return(0,t.useEffect)(()=>{P&&e((0,m.DR)())},[P]),(0,t.useEffect)(()=>{!w&&W?N(!0):N(!1)},[w,W]),(0,t.useEffect)(()=>{Y&&Y.verified&&(s(""),S(Y.accountHash))},[Y]),(0,t.useEffect)(()=>{if(Q){if(Q.mfaSetup){let e=new File([Q.recoveryWords],"2FA.txt",{type:"text/plain"});z(URL.createObjectURL(e)),I(!1),T(!0)}else if("InvalidToken"===Q.error){_("");return}Q.mfaEnabled?k(!0):(k(!1),Q.otpAuthUrl?(async()=>{try{let e=await x.toDataURL(Q.otpAuthUrl);E(e)}catch(e){(0,Z.qu)(!1,"QRCode error.")}})():e((0,m.DR)()))}},[Q]),(0,n.jsx)(p.Z,{children:(0,n.jsxs)(i.Z,{children:[(0,n.jsx)("br",{}),(0,n.jsx)("br",{}),b?(0,n.jsx)("div",{className:"m-3",children:(0,n.jsxs)(c.Z,{xs:12,children:[(0,n.jsx)("h1",{children:"2FA is enabled."}),(0,n.jsx)(d.Z,{variant:"warning",className:"py-2",onClick:()=>O(!0),children:"Disable"}),(0,n.jsx)(u.Z,{show:D,onEntered:()=>{L.current.focus()},onHide:X,children:(0,n.jsxs)(u.Z.Body,{children:[(0,n.jsx)("h3",{children:"Are you sure?"}),(0,n.jsx)(o.Z,{children:(0,n.jsx)(h.Z,{className:"mb-3",children:(0,n.jsx)(o.Z.Control,{ref:L,size:"lg",type:"text",value:U,onChange:e=>q(e.target.value),placeholder:"Yes"})})}),(0,n.jsx)(d.Z,{variant:"primary",className:"pull-right",size:"md",onClick:K,disabled:"Yes"!==U,children:"Go"}),(0,n.jsx)(d.Z,{variant:"light",className:"pull-right",size:"md",onClick:X,children:"Cancel"})]})}),(0,n.jsxs)(u.Z,{show:R,fullscreen:!0,onHide:()=>{confirm("Did you save your 2FA recovery phase? Close this?")&&T(!1)},children:[(0,n.jsx)(u.Z.Header,{closeButton:!0,children:(0,n.jsx)(u.Z.Title,{children:"2FA Recovery Words"})}),(0,n.jsxs)(u.Z.Body,{children:[(0,n.jsx)("p",{children:"Store your recovery words in a secure location. If you lose your 2FA authenticator account, using recovery words is the only way to pass the 2FA step."}),(0,n.jsx)("p",{children:"You can either copy the following recovery words and paste it to a safe location"}),(0,n.jsx)("hr",{}),(0,n.jsx)("h3",{children:Q&&Q.recoveryWords}),(0,n.jsx)("hr",{}),(0,n.jsx)(l.Z,{children:(0,n.jsx)(c.Z,{className:"text-center",children:(0,n.jsx)(d.Z,{variant:"primary",onClick:()=>{navigator.clipboard.writeText(Q.recoveryWords),I(!0)},children:B?"Copied":"Copy"})})}),(0,n.jsx)("br",{}),(0,n.jsx)("p",{children:"or download the following file, rename it, and save it in a secure location."}),(0,n.jsx)(l.Z,{children:(0,n.jsx)(c.Z,{className:"d-flex justify-content-center",children:H&&(0,n.jsx)("a",{href:H,download:"2FA.txt",children:"2FA.txt"})})})]})]})]})}):(0,n.jsxs)("div",{className:"m-3",children:[(0,n.jsx)(l.Z,{children:(0,n.jsx)("h1",{children:"Turn On 2FA"})}),(0,n.jsx)(l.Z,{children:(0,n.jsx)("p",{children:"Step 1. Open your authenticator app., or download one if you don't have any;"})}),(0,n.jsxs)(l.Z,{children:[(0,n.jsx)("p",{children:"Step 2. Add an account by scanning the following QR code;"}),A&&(0,n.jsx)("img",{className:f().qrCode,alt:"qrcode",src:A})]}),(0,n.jsx)(l.Z,{children:(0,n.jsx)("p",{children:"Step 3. Enter the token displayed on your app, then verify."})}),(0,n.jsxs)(l.Z,{children:[(0,n.jsx)(c.Z,{xs:4,md:3,children:(0,n.jsx)(o.Z.Control,{className:f().inputBox,size:"lg",type:"text",placeholder:"",value:F,onChange:e=>_(e.target.value)})}),(0,n.jsx)(c.Z,{xs:8,md:9,children:(0,n.jsx)(d.Z,{variant:"primary",onClick:V,children:"Verify"})})]}),(0,n.jsx)(l.Z,{children:Q&&!Q.mfaSetup&&"InvalidToken"===Q.error&&(0,n.jsx)("p",{style:{color:"red"},children:"Invalid Token"})}),(0,n.jsx)("br",{}),(0,n.jsx)(l.Z,{children:(0,n.jsx)("p",{children:"Step 4. Store your recovery phrase in a secure location. You would need the recovery phrase if you lost your 2FA account."})})]}),(0,n.jsx)(u.Z,{show:C,onEntered:()=>{g(!0)},children:(0,n.jsxs)(u.Z.Body,{children:[(0,n.jsx)("h3",{children:"Please Enter your Password"}),(0,n.jsx)("br",{}),(0,n.jsx)(y.Z,{onKeyChanged:e=>{s(e)},focus:j}),Y&&!Y.verified?(0,n.jsx)("p",{style:{color:"red"},children:"Authentication Failed"}):(0,n.jsx)("br",{}),(0,n.jsx)("br",{}),(0,n.jsx)(d.Z,{variant:"primary",onClick:G,className:"pull-right",children:"Go"})]})})]})})}}},function(e){e.O(0,[6760,2592,1243,9774,2888,179],function(){return e(e.s=26028)}),_N_E=e.O()}]);