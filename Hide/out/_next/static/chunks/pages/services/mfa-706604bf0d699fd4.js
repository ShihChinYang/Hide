(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3486],{56741:function(e,r,a){(window.__NEXT_P=window.__NEXT_P||[]).push(["/services/mfa",function(){return a(41915)}])},41915:function(e,r,a){"use strict";a.r(r),a.d(r,{default:function(){return y}});var s=a(85893),l=a(67294),t=a(9473),i=a(11163),n=a(10682),d=a(52686),c=a(34051),o=a(31555),u=a(13137),f=a(35005),h=a(32171),x=a(38712),v=a.n(x),j=a(31243),m=a(40606),p=a(49486);function y(){let e=(0,i.useRouter)(),r=(0,t.I0)(),[a,x]=(0,l.useState)(""),[y,N]=(0,l.useState)(!1),[Z,g]=(0,l.useState)(""),C=(0,l.useRef)(null),w=(0,l.useRef)(null),R=(0,l.useRef)(null),E=(0,t.v9)(e=>e.auth.mfa),b=(0,t.v9)(e=>e.auth.isLoggedIn);return(0,l.useEffect)(()=>{w.current.focus()},[]),(0,l.useEffect)(()=>{b&&e.push("/safe")},[b]),(0,s.jsx)(j.Z,{children:(0,s.jsx)(n.Z,{children:(0,s.jsxs)("div",{className:"m-3",children:[(0,s.jsx)("br",{}),(0,s.jsx)("br",{}),(0,s.jsxs)(d.Z,{className:"p-3",children:[(0,s.jsxs)(c.Z,{children:[(0,s.jsx)("h1",{children:"Second-Factor Authentication (2FA)"}),(0,s.jsx)("h6",{children:"Please enter the token"})]}),(0,s.jsxs)(c.Z,{children:[(0,s.jsx)(o.Z,{xs:4,md:3,children:(0,s.jsx)(u.Z.Control,{ref:w,className:v().inputBox,size:"lg",type:"text",placeholder:"",value:a,onChange:e=>x(e.target.value)})}),(0,s.jsx)(o.Z,{xs:8,md:9,children:(0,s.jsx)(f.Z,{variant:"primary",onClick:()=>{try{r((0,m.zs)({token:a})),x("")}catch(e){alert(e)}},children:"Verify"})})]}),E&&!E.passed&&(0,s.jsx)(c.Z,{children:(0,s.jsx)(o.Z,{children:(0,s.jsx)("p",{style:{color:"red"},children:"Authentication failed!"})})}),(0,s.jsx)(c.Z,{children:(0,s.jsx)(o.Z,{children:(0,s.jsx)(f.Z,{size:"sm",className:"pull-left",variant:"link",onClick:()=>N(!0),children:"Recover"})})}),(0,s.jsxs)(h.Z,{show:y,fullscreen:!0,onHide:()=>N(!1),children:[(0,s.jsx)(h.Z.Header,{closeButton:!0,children:(0,s.jsx)(h.Z.Title,{children:"2FA Recovery Words"})}),(0,s.jsxs)(h.Z.Body,{children:[(0,s.jsx)("p",{children:"If you lose your 2FA authenticator account, using recovery phrase is the only way to pass the 2FA step."}),(0,s.jsx)("p",{children:"You can either enter your account recovery phrase below"}),(0,s.jsx)(c.Z,{children:(0,s.jsx)(o.Z,{children:(0,s.jsx)(u.Z.Control,{ref:R,className:v().inputBox,size:"lg",type:"text",placeholder:"",value:Z,onChange:e=>g(e.target.value)})})}),(0,s.jsx)("br",{}),(0,s.jsx)(c.Z,{children:(0,s.jsx)(o.Z,{className:"text-center",children:(0,s.jsx)(f.Z,{variant:"primary",onClick:()=>{N(!1),g(""),r((0,m.JA)({recoveryWords:Z}))},children:"Recover"})})}),(0,s.jsx)("br",{}),(0,s.jsx)("p",{children:"or open your 2FA recovery file."}),(0,s.jsxs)("div",{className:"recoveryFile",children:[(0,s.jsx)("input",{ref:C,onChange:e=>{e.preventDefault(),(0,p.qu)(!1,"handleRecoveryFile: ",e.target.id);let a=e.target.files[0],s=new FileReader;s.addEventListener("load",()=>{r((0,m.JA)({recoveryWords:s.result}))},!1),a&&s.readAsText(a)},type:"file",id:"recoveryFile",className:"d-none editControl"}),(0,s.jsx)(c.Z,{children:(0,s.jsx)(o.Z,{id:"recoveryFile",sm:{span:10,offset:1},md:{span:8,offset:2},className:"text-center",children:(0,s.jsx)(f.Z,{id:"recoveryFile",onClick:e=>{var r;(0,p.qu)(!1,"handleRecoveryFile"),e.preventDefault(),C.current.value=null,null===(r=C.current)||void 0===r||r.click()},variant:"link",className:"text-dark btn btn-labeled",children:(0,s.jsx)("h4",{children:(0,s.jsx)("i",{id:"recoveryFile",className:"fa fa-paperclip fa-lg","aria-hidden":"true"})})})})})]})]})]})]})]})})})}},52686:function(e,r,a){"use strict";a.d(r,{Z:function(){return g}});var s=a(94184),l=a.n(s),t=a(67294),i=a(76792),n=a(85893);let d=t.forwardRef(({className:e,bsPrefix:r,as:a="div",...s},t)=>(r=(0,i.vE)(r,"card-body"),(0,n.jsx)(a,{ref:t,className:l()(e,r),...s})));d.displayName="CardBody";let c=t.forwardRef(({className:e,bsPrefix:r,as:a="div",...s},t)=>(r=(0,i.vE)(r,"card-footer"),(0,n.jsx)(a,{ref:t,className:l()(e,r),...s})));c.displayName="CardFooter";var o=a(49059);let u=t.forwardRef(({bsPrefix:e,className:r,as:a="div",...s},d)=>{let c=(0,i.vE)(e,"card-header"),u=(0,t.useMemo)(()=>({cardHeaderBsPrefix:c}),[c]);return(0,n.jsx)(o.Z.Provider,{value:u,children:(0,n.jsx)(a,{ref:d,...s,className:l()(r,c)})})});u.displayName="CardHeader";let f=t.forwardRef(({bsPrefix:e,className:r,variant:a,as:s="img",...t},d)=>{let c=(0,i.vE)(e,"card-img");return(0,n.jsx)(s,{ref:d,className:l()(a?`${c}-${a}`:c,r),...t})});f.displayName="CardImg";let h=t.forwardRef(({className:e,bsPrefix:r,as:a="div",...s},t)=>(r=(0,i.vE)(r,"card-img-overlay"),(0,n.jsx)(a,{ref:t,className:l()(e,r),...s})));h.displayName="CardImgOverlay";let x=t.forwardRef(({className:e,bsPrefix:r,as:a="a",...s},t)=>(r=(0,i.vE)(r,"card-link"),(0,n.jsx)(a,{ref:t,className:l()(e,r),...s})));x.displayName="CardLink";var v=a(39602);let j=(0,v.Z)("h6"),m=t.forwardRef(({className:e,bsPrefix:r,as:a=j,...s},t)=>(r=(0,i.vE)(r,"card-subtitle"),(0,n.jsx)(a,{ref:t,className:l()(e,r),...s})));m.displayName="CardSubtitle";let p=t.forwardRef(({className:e,bsPrefix:r,as:a="p",...s},t)=>(r=(0,i.vE)(r,"card-text"),(0,n.jsx)(a,{ref:t,className:l()(e,r),...s})));p.displayName="CardText";let y=(0,v.Z)("h5"),N=t.forwardRef(({className:e,bsPrefix:r,as:a=y,...s},t)=>(r=(0,i.vE)(r,"card-title"),(0,n.jsx)(a,{ref:t,className:l()(e,r),...s})));N.displayName="CardTitle";let Z=t.forwardRef(({bsPrefix:e,className:r,bg:a,text:s,border:t,body:c=!1,children:o,as:u="div",...f},h)=>{let x=(0,i.vE)(e,"card");return(0,n.jsx)(u,{ref:h,...f,className:l()(r,x,a&&`bg-${a}`,s&&`text-${s}`,t&&`border-${t}`),children:c?(0,n.jsx)(d,{children:o}):o})});Z.displayName="Card";var g=Object.assign(Z,{Img:f,Title:N,Subtitle:m,Body:d,Link:x,Text:p,Header:u,Footer:c,ImgOverlay:h})}},function(e){e.O(0,[6760,1243,9774,2888,179],function(){return e(e.s=56741)}),_N_E=e.O()}]);